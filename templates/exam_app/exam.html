<!DOCTYPE html>
<html>
<head>
    <title>Driving Test</title>
    <style>
    </style>
</head>

<body>
    <h2>Driving Test</h2>

    <p>
      ‚è≥ Time left:
      <strong><span id="timer">20:00</span></strong>
    </p>

    <form method="post">
        {% csrf_token %} {% for q in questions %}
            <div class="question-block">
                <p><strong>{{ forloop.counter }}. {{ q.text }}</strong></p>
                
                {% for choice in q.choices.all %}
                    <input type="radio" name="question_{{ q.id }}" value="{{ choice.id }}" required>
                    <label>{{ choice.text }}</label><br>
                {% endfor %}
            </div>
            <hr>
        {% endfor %}
        
        <button type="submit">Submit Exam</button>
    </form>

    <script>
      let remaining = parseInt("{{ remaining_seconds|default:0 }}", 10);

      function tick() {
        const minutes = Math.floor(remaining / 60);
        const seconds = remaining % 60;

        document.getElementById("timer").textContent =
          minutes + ":" + (seconds < 10 ? "0" + seconds : seconds);

        if (remaining <= 0) {
          document.getElementById("exam-form").submit();
          return;
        }

        remaining--;
        setTimeout(tick, 1000);
      }

      tick();
    </script>
  </body>
</html>
